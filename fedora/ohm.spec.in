%define _enable_debug_packages 0
%define _unpackaged_files_terminate_build 0

Summary: Open Hardware Manager
Name: ohm
Version: ##__VERSION__##
Release: 1
License: Proprietary
Group: System Environment/Daemons
URL: http://127.0.0.1
Source0: %{name}-%{version}.tar.gz
BuildArch: ##__ARCH__##
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
Requires: pl >= 5.6.32, ohm-config, ohm-plugin-core

%package config
Summary: Common configuration files for OHM.
Group: System Environment/Daemons

%package plugin-core
Summary: Common OHM libraries.
Group: System Environment/Daemons

%package devel
Summary: Files necessary for OHM plugin development.
Group: Development/Libraries
Requires: ohm-plugin-core

%package plugins-legacy
Summary: Legacy plugins for the Open Hardware Manager.
Group: System Environment/Daemons

%package utils
Summary: Miscallaneous OHM utilities.
Group: System Environment/Daemons

%description
Open Hardware Manager

%description config
This package contains common OHM configuration files.

%description plugin-core
This package contains libraries needed by both for running OHM and
developing OHM plugins.

%description devel
This package contains header files, libraries, pkg-config files, etc.
necessary for developing OHM plugins.

%description legacy-plugins
Lagacy plugins for OHM.

%description utils
This package contains miscallaneous OHM utilities that are either not
very useful or not necessary for everyday OHM usage.

%prep
%setup -q -n ##__TARDIR__##

%build
export CFLAGS="-O0 -g3"
%configure --disable-static --without-xauth --disable-dpms
make

%install
[ "$RPM_BUILD_ROOT" != "/" ] && rm -rf $RPM_BUILD_ROOT
%makeinstall


%clean
[ "$RPM_BUILD_ROOT" != "/" ] && rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root,-)
%{_initrddir}/ohmd
%{_sbindir}/*ohm*
%{_datadir}/locale

%files config
%defattr(-,root,root,-)
%dir %{_sysconfdir}/ohm
%dir %{_sysconfdir}/ohm/plugins.d
%config %{_sysconfdir}/ohm/modules.ini
%config %{_sysconfdir}/dbus-1/system.d/ohm.conf

%files plugin-core
%defattr(-,root,root,-)
%{_libdir}/libohmplugin.*
%{_libdir}/libohmfact.*

%files devel
%defattr(-,root,root,-)
%{_includedir}/ohm
%{_libdir}/libohm.*
%{_libdir}/pkgconfig/*

%files legacy-plugins
%defattr(-,root,root,-)
%config %{_sysconfdir}/ohm/plugins.d/*
%{_libdir}/ohm

%files utils
%defattr(-,root,root,-)
%{_bindir}/*ohm*


%changelog
* Wed Apr 9 2008 Krisztian Litkey <kli@localhost.localdomain> - 
- Initial build.

